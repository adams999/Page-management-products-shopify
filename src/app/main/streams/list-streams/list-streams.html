<div class="pb-0 container-fluid">
  <div class="row">
    <div class="col-md-5 stream-header col-sm-12">
      <h4>Streams</h4>
      <!-- <span class="description-text"> Lorem ipsum dolor sit amet, consectetur tempor. </span> -->
    </div>
    <div class="col-md-7 stream-statistics col-sm-12">
      <div class="row stat-area-header">
        <div class="col-md-6 stream-total-views col-sm-12 border-style ">
          <div class="card head shadow-box">
            <div class="text-center card-body">
              <span class="card-left"> <img src="/assets/icons-simustream/Card-eye-back.svg" alt=""> </span>
              <span class="description-text card-center"> Total Views</span>
              <span class="card-right">{{streamsTotalViews}}</span>
            </div>
          </div>
        </div>
        <div class="col-md-6 stream-total-sales col-sm-12 border-style">
          <div class="card head shadow-box">
            <div class="text-center card-body">
              <span class="card-left"> <img src="/assets/icons-simustream/card-dollar.svg" alt=""> </span>
              <span class="description-text card-center"> Total Sales</span>
              <span class="card-right"> ${{streamsTotalSales}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-4 list-streams-main row">
    <div class="col-md-12">
      <div class="p-0 pt-3 pl-3  bg border-style shadow-box">
        <div class="pb-3 m-0 row" [ngClass]="displayStyle == 'grid'? 'grid-table': 'list-table'">
          <div class="pl-0 col-md-4 col-sm-12 stream-q">
            <h6>{{streams.length}} {{streams.length > 1 || streams.length == 0 ? 'Streams': 'Stream'}}</h6>
          </div>
          <div class="p-0 text-right col-md-8 active-list-filters col-sm-12">
            <form>
              <div class="form-row ">
                <div class="mr-3 form-group form-filter btn-filter">
                  <div class="dropdown filter">
                    <button class="btn btn-secondary btn-w-100 dropdown-toggle" type="button" id="dropdownMenu2"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      {{currentFilter}}
                      <img class="ml-2" src="/assets/icons-simustream/Arrow-up-down.svg" alt="">
                    </button>
                    <div class="dropdown-menu filter-menu" aria-labelledby="dropdownMenu2">
                      <button class="dropdown-item" type="button"
                        (click)="filterFunc('Date published', 'publishedAt')">Date
                        published</button>
                      <button class="dropdown-item" type="button" (click)="filterFunc('Total viewers','views')">Total
                        viewers</button>
                      <button class="dropdown-item" type="button" (click)="filterFunc('Total sales','sales')">Total
                        sales</button>
                    </div>
                  </div>
                </div>
                <div class="mr-3 form-group form-filter btn-filter">
                  <div class="dropdown filter">
                    <button class="btn btn-secondary btn-w-100 dropdown-toggle" type="button" id="dropdownMenu2"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <img class="mr-2" src="/assets/icons-simustream/filters.svg" alt="">
                      Filters
                      <img class="ml-2" src="/assets/icons-simustream/Arrow-up-down.svg" alt="">
                    </button>
                    <div class="text-center dropdown-menu check" #dropmenu>
                      <form class="pt-3 pb-2 pl-3 pr-3 ">
                        <div class="form-group">
                          <label for="" class="float-left"></label>
                          <div class="select-wrapper">
                            <select class="form-control " [(ngModel)]="filterKeys.status" (change)="applyFilter(dropmenu)" name="filterKey"
                              id="filterKey">
                              <option value="" selected disabled>Status</option>
                              <option value="publish" selected>Published</option>
                              <option value="unpublish">Unpublished</option>
                            </select>
                            <i class="fa fa-chevron-down"></i>
                          </div>
                        </div>
                        <!-- <button type="submit" class="btn btn-sign-in " (click)="applyFilter()">Apply</button> -->
                      </form>
                    </div>
                  </div>
                </div>
                <div class="mb-0 form-group form-filter button-menu">
                  <div class="btn-group btn-w-100" role="toolbar" aria-label="Basic example">
                    <button type="checkbox" class="pt-1 btn btn-multiple btn-left" (click)="switchDisplay('list')">
                      <img *ngIf="displayStyle== 'grid'" src="/assets/icons-simustream/list-view.svg" alt="">
                      <img *ngIf="displayStyle == 'list'" src="/assets/icons-simustream/list-view-active.svg" alt="">
                    </button>
                    <button type="checkbox" (click)="switchDisplay('grid')" class="pt-1 btn btn-multiple btn-right">
                      <img *ngIf="displayStyle== 'list'" src="/assets/icons-simustream/grid-view.svg" alt="">
                      <img *ngIf="displayStyle == 'grid'" src="/assets/icons-simustream/grid-view-active.svg" alt="">
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>

        </div>

        <div class="p-0 height-ch col-sm-12" (scroll)="onElementScroll($event)" id="client">
          <table *ngIf="displayStyle == 'list'" class="table bg" id="grid">
            <thead>
              <tr>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of streams ; let i = index">
                <span class="cursor-pointer" (click)="item.status=='publish'? openStream(item._id, item.video.videoOriginalId) : null">
                  <td style="width: 7%" class="pl-0 img-scene"><img
                      src="{{item.video ?  item.video.thumbnail : item.thumbnail}}" alt=""></td>
                  <td class="pl-0" style="width: 40%">
                    <div class="top-set"><span class="text"> {{item.name}}</span></div>
                    <div>
                      <span class="mt-2 badge badge-light">{{item.category}}</span></div>
                  </td>
                  <td>
                    <div class="top-set"> <span class="text"> {{item.views ? item.views : 0}} </span><br> <span
                        class="description-text font-regular">Total views</span></div>
                  </td>
                  <td>
                    <div class="top-set"> <span class="text">${{item.sales ? totalSalesDecimalHandled(item.sales) : 0}} </span><br> <span
                        class="description-text font-regular">Total sales</span></div>
                  </td>
                  <td class="" style="width: 15%">
                    <div class="top-set"> <span
                        [ngClass]="item.status == 'publish' ? 'badge badge-success': 'badge badge-light'">{{item.status == 'publish'? 'Published' : 'Unpublished' }}</span>
                      <div>
                        <span class="description-text font-regular">{{calculateDuration(item.createdAt)}}
                          {{now ? 'ago':''}}</span>
                      </div>
                    </div>
                  </td>
                </span>
                <td class="p-0 text-right acc">
                  <div class="dropdown ">
                    <button class="btn btn-more " type="button" id="dropdownMenuButton" data-toggle="dropdown"
                      aria-haspopup="true" aria-expanded="false">
                      <img src="/assets/More.svg" alt="more">
                    </button>
                    <div class="dropdown-menu dropdown-menu-right ">
                      <!-- <button class="dropdown-item"
                        (click)="changeStatus({isArchive: item.isArchive,_id:item._id})">Archive</button> -->
                      <button class="dropdown-item" [disabled]="apiLimits.maxVideosLimitReached && item.status!='publish'"
                        (click)="changeStatus({status: item.status,_id:item._id})">{{item.status == 'publish'? 'Unpublish' : 'Publish' }}</button>
                      <button class="dropdown-item" [routerLink]="['/edit-stream',item._id]">Edit</button>
                      <button class="dropdown-item" [routerLink]="['/stadistics',item._id]">Stadistics</button>
                      <button class="dropdown-item" (click)="shareStream(content,item)">Share</button>
                      <div class="dropdown-divider"></div>
                      <button class="dropdown-item"
                      (click)="changeStatus({isArchive: item.isArchive,_id:item._id})">Archive</button>
                      <!-- <button class="dropdown-item" (click)="deleteStreamById(item._id)">Delete</button> -->
                    </div>
                  </div>
                  <!-- <div ngbDropdown  class="d-inline-block">
                    <button class="btn btn-more" id="dropdownBasic1" ngbDropdownToggle>
                      <img src="/assets/More.svg" alt="more">
                    </button>
                    <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                      <button ngbDropdownItem class="dropdown-item">Archive</button>
                      <button ngbDropdownItem class="dropdown-item"
                        [routerLink]="['/edit-stream',item._id]">Edit</button>
                      <button ngbDropdownItem class="dropdown-item">Share</button>
                      <div class="dropdown-divider"></div>
                      <button ngbDropdownItem class="dropdown-item" (click)="deleteStreamById(item._id)">Delete</button>
                    </div>
                  </div> -->
                </td>
              </tr>
            </tbody>
          </table>

          <div *ngIf="displayStyle == 'grid'" class="mt-3 ml-2 mr-2 row" id="grid">

            <div class="pl-0 col-md-3 card-count col-sm-6" *ngFor="let item of streams ; let i = index">
              <div class="mb-3 card stream">
                <img src="{{item.video ?  item.video.thumbnail : item.thumbnail}}" class="cursor-pointer card-img-top"
                  alt="..." (click)="item.status=='publish'? openStream(item._id, item.video.videoOriginalId) : null">
                <div class="card-body">
                  <p class="card-title">{{item.name}}</p>
                  <div class="row">
                    <div class="col"><span class="text"> {{item.views ? item.views : 0}} </span><br> <span
                        class="description-text font-regular">Total views</span></div>
                    <div class="col"><span class="text">${{item.sales ? totalSalesDecimalHandled(item.sales) : 0}} </span><br> <span
                        class="description-text font-regular">Total sales</span></div>
                  </div>
                  <div>
                    <span
                      [ngClass]="item.status == 'publish' ? 'badge badge-success mt-3': 'badge badge-light mt-3'">{{item.status == 'publish'? 'Published' : 'Unpublished' }}</span>
                  </div>
                  <div class="mt-1 row">
                    <div class="pr-0 col-9">
                      <small class="text-muted">{{calculateDuration(item.createdAt)}} {{now ? 'ago':''}}</small>
                    </div>
                    <div class="pr-0 text-right col-3">
                      <div class="dropdown ">
                        <button class="pb-0 pl-0 btn btn-more rotate" type="button" id="dropdownMenuButton"
                          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <img src="/assets/More.svg" alt="more">
                        </button>
                        <div class="dropdown-menu dropdown-menu-right ">
                          <!-- <button class="dropdown-item"
                            (click)="changeStatus({isArchive: item.isArchive,_id:item._id})">Archive</button> -->
                          <button class="dropdown-item" [disabled]="apiLimits.maxVideosLimitReached && item.status!='publish'"
                            (click)="changeStatus({status: item.status,_id:item._id})">{{item.status == 'publish'? 'Unpublish' : 'Publish' }}</button>
                          <button class="dropdown-item" [routerLink]="['/edit-stream',item._id]" [disabled]="apiLimits.maxVideosLimitReached && item.status!='publish'">Edit</button>
                          <button class="dropdown-item" *ngIf="splitIoService.isTreatmentOn('stadisticStream')" [routerLink]="['/stadistics',item._id]">Stadistics</button>
                          <button class="dropdown-item" (click)="shareStream(content,item)">Share</button>
                          <div class="dropdown-divider"></div>
                          <button class="dropdown-item"
                          (click)="changeStatus({isArchive: item.isArchive,_id:item._id})">Archive</button>
                          <!-- <button class="dropdown-item" (click)="deleteStreamById(item._id)">Delete</button> -->
                        </div>
                      </div>
                    </div>

                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pt-2 m-0 mt-2 row create-stream-bottom">
        <main-stream-button-app [buttonTitle]='buttonTitle' [navigateTo]='buttonNavigation'
          [isCardExpired]='isCardExpired' [isActive]='isActive' [isApiLimitReached]='isApiLimitReached'
          [currentPage]='currentPage'></main-stream-button-app>
      </div>
    </div>
  </div>

</div>


<ng-template #content let-modal>
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <img src="assets/icons-simustream/cross.svg" alt="">
    </button>
  </div>
  <div class="modal-body">
    <!-- <span class="check"> <img src="assets/icons-simustream/checkCircle.svg" alt=""></span>
    <h4 class="mt-4 mb-5 modal-title" id="modal-basic-title">Congratulations! You have updated the stream!</h4> -->
    <!-- <div class="slider">
      <img class="s-node" src="assets/icons-simustream/progressBarNode.svg" alt="">
      <img class="s-slider" src="assets/icons-simustream/progressBarSlider.svg" alt="">
      <img class="s-back" src="assets/icons-simustream/progressBarBack.svg" alt="">
    </div> -->
    <div *ngIf="isCustom">
      <h4 class="mt-4 mb-5 modal-title" id="modal-basic-title">This is your unique Stream ID</h4>
      <p class="mt-4 plain" id="modal-basic-title">Stream id: {{streamId}}</p>
    </div>
    <div *ngIf="!isCustom">
      <p class="mt-4 plain" id="modal-basic-title">Share via your social media:</p>
      <span class="media">
        <img class="mr-1 share-icon" (click)="share('facebook')" src="assets/icons-simustream/facebook.svg" alt="">
        <img class="ml-1 share-icon" (click)="share('twitter')" src="assets/icons-simustream/twitter.svg" alt="">
        <img class="ml-1 share-icon" (click)="share('linkedin')" src="assets/icons-simustream/linkedin.svg" alt="">
      </span>
      <form>
        <div class="mt-4 text-left row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="">Link</label>
              <div class="input-group tooltip-hover">
                <img src="assets/icons-simustream/linkIcon.svg" alt="">
                <span class="tooltiptext" id="myTooltip">Copy to clipboard</span>
                <input [(ngModel)]="linkStream" (click)="copyInputMessage(userinput)" #userinput name="link" id="link"
                  class="form-control link-input copy-clipboard " ng-mouseleave="outFunc()" placeholder="Stream Link"
                  readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="">Embeded Code</label>
              <div class="input-group tooltip-hover">
                <span class="tooltiptext" id="myTooltip1">Copy to clipboard</span>
                <input [(ngModel)]="iframeText" (click)="copyInputMessage1(userinput1)" #userinput1 name="iframetext"
                  id="iframetext" class="form-control copy-clipboard " ng-mouseleave="outFunc()" placeholder="iframe"
                  readonly>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

</ng-template>
